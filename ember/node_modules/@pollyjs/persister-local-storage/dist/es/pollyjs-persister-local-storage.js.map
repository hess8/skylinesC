{"version":3,"file":"pollyjs-persister-local-storage.js","sources":["../../src/index.js"],"sourcesContent":["import Persister from '@pollyjs/persister';\n\nconst { parse } = JSON;\n\nexport default class LocalStoragePersister extends Persister {\n  static get name() {\n    return 'local-storage';\n  }\n\n  get defaultOptions() {\n    return {\n      key: 'pollyjs',\n      context: global\n    };\n  }\n\n  get localStorage() {\n    const { context } = this.options;\n\n    this.assert(\n      `Could not find \"localStorage\" on the given context \"${context}\".`,\n      context && context.localStorage\n    );\n\n    return context.localStorage;\n  }\n\n  get db() {\n    const items = this.localStorage.getItem(this.options.key);\n\n    return items ? parse(items) : {};\n  }\n\n  set db(db) {\n    this.localStorage.setItem(this.options.key, this.stringify(db));\n  }\n\n  findRecording(recordingId) {\n    return this.db[recordingId] || null;\n  }\n\n  saveRecording(recordingId, data) {\n    const { db } = this;\n\n    db[recordingId] = data;\n    this.db = db;\n  }\n\n  deleteRecording(recordingId) {\n    const { db } = this;\n\n    delete db[recordingId];\n    this.db = db;\n  }\n}\n"],"names":["parse","JSON","LocalStoragePersister","Persister","name","defaultOptions","key","context","global","localStorage","options","assert","db","items","getItem","setItem","stringify","findRecording","recordingId","saveRecording","data","deleteRecording"],"mappings":";;;;;;;;;AAEA,MAAM;EAAEA;IAAUC,IAAlB;AAEA,AAAe,MAAMC,qBAAN,SAAoCC,SAApC,CAA8C;aAChDC,IAAX,GAAkB;WACT,eAAP;;;MAGEC,cAAJ,GAAqB;WACZ;MACLC,GAAG,EAAE,SADA;MAELC,OAAO,EAAEC;KAFX;;;MAMEC,YAAJ,GAAmB;UACX;MAAEF;QAAY,KAAKG,OAAzB;SAEKC,MAAL,CACG,uDAAsDJ,OAAQ,IADjE,EAEEA,OAAO,IAAIA,OAAO,CAACE,YAFrB;WAKOF,OAAO,CAACE,YAAf;;;MAGEG,EAAJ,GAAS;UACDC,KAAK,GAAG,KAAKJ,YAAL,CAAkBK,OAAlB,CAA0B,KAAKJ,OAAL,CAAaJ,GAAvC,CAAd;WAEOO,KAAK,GAAGb,KAAK,CAACa,KAAD,CAAR,GAAkB,EAA9B;;;MAGED,EAAJ,CAAOA,EAAP,EAAW;SACJH,YAAL,CAAkBM,OAAlB,CAA0B,KAAKL,OAAL,CAAaJ,GAAvC,EAA4C,KAAKU,SAAL,CAAeJ,EAAf,CAA5C;;;EAGFK,aAAa,CAACC,WAAD,EAAc;WAClB,KAAKN,EAAL,CAAQM,WAAR,KAAwB,IAA/B;;;EAGFC,aAAa,CAACD,WAAD,EAAcE,IAAd,EAAoB;UACzB;MAAER;QAAO,IAAf;IAEAA,EAAE,CAACM,WAAD,CAAF,GAAkBE,IAAlB;SACKR,EAAL,GAAUA,EAAV;;;EAGFS,eAAe,CAACH,WAAD,EAAc;UACrB;MAAEN;QAAO,IAAf;WAEOA,EAAE,CAACM,WAAD,CAAT;SACKN,EAAL,GAAUA,EAAV;;;;;;;"}